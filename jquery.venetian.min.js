(function(t,s,i,e){function n(s,i,e){var n="";["-webkit-","-moz-","-ms-","-o-",""].forEach(function(a){n=a+i,t(s).css(n,e)})}function a(s,i){this.element=s,this.options=t.extend({},r,i),this._defaults=r,this._name=o,this.init()}var o="venetian",r={stripeSpaceClass:"stripe-space",stripeClass:"stripe",stripeFaceClass:"stripe__face",stripeFaceFrontClass:"stripe__face--front",stripeFaceTopClass:"stripe__face--top",stripeFaceBottomClass:"stripe__face--bottom",stripeInnerFaceClass:"stripe__face__inner",animationDuration:1e3,animationDelay:100,animationInterval:5e3,stripes:3};a.prototype={init:function(){this.build(),this.photon()},build:function(){for(var s=0;this.options.stripes>s;s++)this.addStripe();this.stripes=t(this.element).find("."+this.options.stripeClass),this.currentAngle=0,this.flaps=[]},addStripe:function(){var s=this,i=t("<section></section>").addClass(this.options.stripeSpaceClass),e=t("<div></div>").addClass(this.options.stripeClass),n=t("<figure></figure>").addClass(this.options.stripeFaceFrontClass),a=t("<figure></figure>").addClass(this.options.stripeFaceTopClass),o=t("<figure></figure>").addClass(this.options.stripeFaceBottomClass);t([n,a,o]).each(function(i,e){e.addClass(s.options.stripeFaceClass),e.append(t("<span></span>").addClass(s.options.stripeInnerFaceClass))}),e.append(n).append(a).append(o),i.append(e),t(this.element).append(i)},addFlap:function(s){if(s.length>this.options.stripes)throw"There isn't enough stripes for the contents submitted";var i=this;this.flaps.push(s),1==this.flaps.length&&this.stripes.each(function(s,e){var n=t(e).find("."+i.options.stripeFaceClass)[0];i.loadFaceContent(n,s,0)})},loadFaceContent:function(s,i,e){var n=e%this.flaps.length,a=this.flaps[n][i];a&&(t(s).find("."+this.options.stripeInnerFaceClass).html(a.html),a.styles&&"object"==typeof a.styles?t(s).css(a.styles):t(s).removeAttr("style"))},photon:function(){function i(){o.forEach(function(t){t.render(a,!0)})}if(s.Photon===e)return console.error("The Photon javascript lighting engine cannot be found. The animations will suck !"),e;var n=this.options.stripeFaceClass,a=new Photon.Light(0,0,1e3),o=[];this.stripes.each(function(){o.push(new Photon.FaceGroup(this,t(this).find("."+n),.5))}),this.photonTimer=setInterval(i,34)},animate:function(){var t=this;this.animationTimer=setTimeout(function(){t.next()},this.options.animationInterval)},next:function(){var s=this,i=this.options.animationDelay,e=this.currentAngle+120;clearTimeout(this.animationTimer),this.stripes.each(function(a,o){var r=0==a%2,p=(r?-1:1)*e,h=(-p/120>>0)%3;0>h&&(h+=3);var c=t(o).find("."+s.options.stripeFaceClass+":eq("+h+")"),l=e/120;s.loadFaceContent(c,a,l),setTimeout(function(){n(o,"transform","rotateX( "+p+"deg )")},a*i)}),this.currentAngle=e,this.animate()}},t.fn[o]=function(s){return this.each(function(){t.data(this,"plugin_"+o)||t.data(this,"plugin_"+o,new a(this,s))})}})(jQuery,window,document);